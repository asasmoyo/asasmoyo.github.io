<!doctype html><html xmlns=http://www.w3.org/1999/xhtml lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Setup PostgreSQL on Ubuntu 16.04 | relax, you're probably doing fine</title><link href=https://asasmoyo.github.io/index.xml rel=alternate type=application/rss+xml title="relax, you're probably doing fine"><link rel=stylesheet href=/css/style.css><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://asasmoyo.github.io/blog/setup-postgresql/><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"></head><body><section class=section><div class=container><nav id=nav-main class=nav><div id=nav-name class=nav-left><a id=nav-anchor class=nav-item href=https://asasmoyo.github.io><h1 id=nav-heading class="title is-4">relax, you're probably doing fine</h1></a></div><div class=nav-right><nav id=nav-items class="nav-item level is-mobile"><a class=level-item aria-label=email href=mailto:arba.sasmoyo@gmail.com target=_blank rel=noopener><span class=icon><i><svg viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></i></span></a><a class=level-item aria-label=github href=https://github.com/asasmoyo target=_blank rel=noopener><span class=icon><i><svg viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></i></span></a><a class=level-item aria-label=linkedin href=https://linkedin.com/in/asasmoyo target=_blank rel=noopener><span class=icon><i><svg viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path stroke-width="1.8" d="m5.839218 4.101561c0 1.211972-.974141 2.194011-2.176459 2.194011S1.4863 5.313533 1.4863 4.101561c0-1.211094.974141-2.194011 2.176459-2.194011s2.176459.982917 2.176459 2.194011zm.017552 3.94922h-4.388022v14.04167H5.85677V8.050781zm7.005038.0H8.501869v14.04167h4.360816v-7.370999c0-4.098413 5.291077-4.433657 5.291077.0v7.370999h4.377491v-8.89101c0-6.915523-7.829986-6.66365-9.669445-3.259423V8.050781z"/></svg></i></span></a></nav></div></nav><nav class=nav></nav></div><script src=/js/navicon-shift.js></script></section><section class=section><div class=container><div class="subtitle tags is-6 is-pulled-right"></div><h2 class="subtitle is-6">March 14, 2017</h2><h1 class=title>Setup PostgreSQL on Ubuntu 16.04</h1><div class=content><h3 id=install-postgresql>Install PostgreSQL</h3><p>By default, Ubuntu 16.04 instance has already <code>postgresql</code> package, but it is pretty out of date. You can still install latest version available (currently 9.6) by adding PostgreSQL repo into your ubuntu instance.</p><p>First create a file at <code>/etc/apt/sources.list.d/postgres.list</code> with this content</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>deb http://apt.postgresql.org/pub/repos/apt/ xenial-pgdg main
</code></pre></div><p>Then run these commands to install PostgreSQL signing key and also install PostgreSQL 9.6</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -
sudo apt-get update
sudo apt-get install postgresql-9.6
</code></pre></div><p>Now PostgreSQL should already running on your machine. To check it you can use</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo systemctl status postgresql
</code></pre></div><h3 id=create-user-and-database>Create User and Database</h3><p>Newly created PostgreSQL instance has a superuser called <code>postgres</code> without a password. Fortunately <code>postgres</code> user can only login from <code>localhost</code> so it should be secure by default. If you want to add password to <code>postgres</code> you can run</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo su postgres -c psql

<span style=color:#75715e># after in PostgreSQL cli</span>
<span style=color:#ae81ff>\p</span>assword
</code></pre></div><p>It is better to have it&rsquo;s own user and database for each applications. To create them you can use</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># create user first</span>
create user <span style=color:#e6db74>&#34;user_name&#34;</span> with password <span style=color:#e6db74>&#39;please_change_me&#39;</span> login;

<span style=color:#75715e># then create database</span>
create database <span style=color:#e6db74>&#34;db_name&#34;</span> owner <span style=color:#e6db74>&#39;user_name&#39;</span>;
</code></pre></div><h3 id=allow-remote-connections>Allow Remote Connections</h3><p>The PostgreSQL instance that have been installed will listen to <code>localhost</code> and only allow <code>postgres</code> user to connect inside the machine without password authentication. To enable remote connections, there are 2 things that need to be done.</p><p>First you must change PostgreSQL listen address to your machine ip, for example your machine private ip. Open <code>/etc/postgresql/9.6/main/postgresql.conf</code> and find this line</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e>#listen=&#39;localhost&#39;</span>
</code></pre></div><p>Change it into</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>listen<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;your_private_ip&#39;</span>
</code></pre></div><p>Then you also need to allow remote connections to access your PostgreSQL instance. To do that open <code>/etc/postgresql/9.6/main/pg_hba.conf</code> and add this line to the end of the file</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>host db_name user_name 0.0.0.0/0 md5
</code></pre></div><p>It will allows remote connections from anywhere (notice <code>0.0.0.0/0</code>) to access <code>db_name</code> with user <code>user_name</code>. You can improve the security by changing <code>0.0.0.0/0</code> to specific address, like <code>192.168.1.20/32</code>. Restart the PostgreSQL instance by <code>sudo systemctl restart postgresql</code> then your remote clients should be able to connect to your PostgreSQL instance.</p><div class=related></div></div></div></section><section class=section><div class=container><aside><div id=disqus_thread></div></aside><div id=show_comments><a id=load_comments class="button is-link">Load comments</a></div><script type=text/javascript>var disqus_shortname='asasmoyo-github-io';function disqus(){var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);}
var hash=window.location.hash.substr(1);if((hash.length>8)&&(hash.substring(0,8)==="comment-")){disqus();document.getElementById("show_comments").style.display="none";}else{document.getElementById('load_comments').onclick=function(){disqus();document.getElementById("show_comments").style.display="none";};}</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript rel=nofollow>comments powered by Disqus.</a></noscript></div></section><section class=section><div class="container has-text-centered"><p></p></div></section><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-109033209-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>